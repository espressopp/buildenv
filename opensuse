FROM opensuse/tumbleweed:latest
RUN zypper install -y gcc-c++ openmpi2-devel boost-devel libboost_filesystem-devel \
    libboost_mpi-devel libboost_python3-devel libboost_serialization-devel \
    libboost_system-devel libboost_test-devel \
    python3-mpi4py-devel python3-devel cmake ccache fftw3-devel hdf5 hdf5-devel \
    gromacs-devel python3-pip llvm-clang python3-h5py sudo

RUN groupadd -r wheel
RUN useradd -m -G wheel -U espressopp
RUN echo '%wheel ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers
USER espressopp
ENV PATH=/usr/lib64/ccache${PATH:+:}${PATH}
ENV LD_LIBRARY_PATH=/usr/lib64/mpi/gcc/openmpi/lib64:/usr/lib64/mpi/gcc/openmpi2/lib64${LD_LIBRARY_PATH:+:}${LD_LIBRARY_PATH}
WORKDIR /home/espressopp
RUN pip3 install --user codecov coverxygen
